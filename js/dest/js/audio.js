!function(){"use strict";function t(){this.initialize.apply(this,arguments)}t.prototype.initialize=function(){this.settingsData=JSON.parse(localStorage.getItem("settingsData"))||[],this.isSettingsOpen=!0,this.settingsElm=document.querySelector(".js-settings"),this.settingsRadioElm=this.settingsElm.querySelectorAll('input[type="radio"]'),this.settingsSelectElm=this.settingsElm.querySelectorAll("select"),this.settingsSelectNumElm=this.settingsSelectElm[0],this.settingsSelectRepeatElm=this.settingsSelectElm[1],this.settingsSelectSpeedElm=this.settingsSelectElm[2],this.settingsSelectAccelerationElm=this.settingsSelectElm[3],this.settingsSelectDigitElm=this.settingsSelectElm[4],this.settingsTextElm=this.settingsElm.querySelectorAll('input[type="text"]'),this.settingsInputNumElm=this.settingsTextElm[0],this.settingsInputPathElm=this.settingsTextElm[1],this.settingsInputFileName1Elm=this.settingsTextElm[2],this.settingsInputFileName2Elm=this.settingsTextElm[3],this.showElm=document.querySelector(".js-show"),this.videoElm=document.querySelector(".js-video"),this.btnElm=document.querySelector(".js-btn"),this.showNumElm=this.settingsInputFileName1Elm.nextSibling,this.path=this.settingsData.path||"",this.digit=this.settingsData.digit||1,this.fileName1=this.settingsData.filename1||"",this.fileName2=this.settingsData.filename2||"",this.num=this.settingsData.no||1,this.endNum=1e3,this.cnt=0,this.repeat=this.settingsData.repeat||1,this.acceleration=this.settingsData.acceleration||0,this.speedInit=this.settingsData.speed||1,this.showNumElm.innerHTML=this.num},t.prototype.getOption=function(e,i,s){let n="";for(let t=e;t<=i;t+=s)n+='<option value="'+Math.round(100*t)/100+'">'+Math.round(100*t)/100+"</option>";return n},t.prototype.setOption=function(){this.settingsSelectNumElm.innerHTML=this.getOption(1,1050,1),this.settingsSelectSpeedElm.innerHTML=this.getOption(.55,10,.05),this.settingsSelectAccelerationElm.innerHTML=this.getOption(0,.1,.01),this.settingsSelectRepeatElm.innerHTML=this.getOption(1,300,1),this.settingsSelectDigitElm.innerHTML=this.getOption(1,5,1)},t.prototype.setValue=function(){this.settingsSelectNumElm.value=this.num,this.settingsSelectRepeatElm.value=this.repeat,this.settingsSelectSpeedElm.value=this.speedInit,this.settingsSelectAccelerationElm.value=this.acceleration,this.settingsInputPathElm.value=this.path,this.settingsSelectDigitElm.value=this.digit,this.settingsInputFileName1Elm.value=this.fileName1,this.settingsInputFileName2Elm.value=this.fileName2},t.prototype.selectType=function(t){let e=t.target.dataset.index;document.querySelectorAll(".js-showInputRadio").forEach(t=>{t.dataset.index===e?t.classList.remove("disp--none"):t.classList.add("disp--none")})},t.prototype.getShowElm=function(){return"現在再生中の問題の番号："+this.num+"<br>残り："+(this.repeat-this.cnt)+"/"+this.repeat+"回<br>スピード："+this.speed+"秒<br>加速："+this.acceleration+"秒"},t.prototype.saveSettings=function(t,e,i,s,n,l,h,a){localStorage.setItem("settingsData",JSON.stringify({no:t,repeat:e,speed:i,acceleration:s,path:n,digit:l,filename1:h,filename2:a}))},t.prototype.setShowNum=function(){this.digit=this.settingsSelectDigitElm.value,this.num=this.settingsSelectNumElm.value,this.showNumElm.innerHTML=this.getSerialNumber()},t.prototype.setNum=function(t){this.isSettingsOpen?(this.num=this.settingsSelectNumElm.value,this.repeat=this.settingsSelectRepeatElm.value,this.speedInit=parseFloat(this.settingsSelectSpeedElm.value),this.speed=this.speedInit,this.acceleration=parseFloat(this.settingsSelectAccelerationElm.value),this.path=this.settingsInputPathElm.value,this.digit=parseFloat(this.settingsSelectDigitElm.value),this.fileName1=this.settingsInputFileName1Elm.value,this.fileName2=this.settingsInputFileName2Elm.value,this.saveSettings(this.num,this.repeat,this.speedInit,this.acceleration,this.path,this.digit,this.fileName1,this.fileName2),this.settingsElm.classList.add("disp--none"),this.btnElm.innerHTML="設定を表示する",this.isSettingsOpen=!this.isSettingsOpen,this.showElm.innerHTML=this.getShowElm(),this.videoElm.parentNode.className="",this.setPath(),this.videoElm.load(),this.videoPlayRateControllerSet()):(this.settingsElm.classList.remove("disp--none"),this.btnElm.innerHTML="設定して再生する",this.isSettingsOpen=!this.isSettingsOpen)},t.prototype.getSerialNumber=function(){let e="";for(let t=0;t<this.digit;++t)e+="0";return(e+this.num).slice(-this.digit)},t.prototype.setPath=function(){var t=this.getSerialNumber(),t=this.path+this.fileName1+t+this.fileName2+".mp3";this.videoElm.innerHTML='<source src="'+t+'" type="video/mp4">'},t.prototype.videoPlayRateControllerSet=function(){this.videoElm.addEventListener("loadeddata",this.videoPlayRateController1.bind(this)),this.videoElm.addEventListener("ended",this.videoPlayRateController.bind(this))},t.prototype.videoPlayRateController1=function(){this.videoElm.playbackRate=this.speed},t.prototype.videoPlayRateController=function(){this.num>=this.endNum?videoElm.pause():(this.cnt>=this.repeat-1?(++this.num,this.speed=this.speedInit,this.setPath(),this.cnt=0):(++this.cnt,this.speed=this.speedInit+this.cnt*this.acceleration,this.videoElm.playbackRate=this.speed),this.showElm.innerHTML=this.getShowElm(),this.videoElm.load())},t.prototype.setEvent=function(){this.setOption(),this.setValue(),this.settingsSelectDigitElm.addEventListener("change",this.setShowNum.bind(this)),this.settingsSelectNumElm.addEventListener("change",this.setShowNum.bind(this)),this.btnElm.addEventListener("click",this.setNum.bind(this)),this.settingsRadioElm.forEach(t=>{t&&t.addEventListener("change",this.selectType.bind(t))})},t.prototype.run=function(){this.setEvent()},window.addEventListener("DOMContentLoaded",function(){(new t).run()})}();